<!DOCTYPE html>
<html lang="zh" dir="src/zh">
  <head>
    <meta charset="utf-8">
    
    <title>ELFK | deploy-docs</title>
    <meta name="description" content="更快的 deploy">
    <meta name="generator" content="VitePress v1.2.3">
    <link rel="preload stylesheet" href="/deploy-docs/public/style.3ZL2aLZq.css" as="style">
    
    <script type="module" src="/deploy-docs/public/app.CpIkeuy9.js"></script>
    <link rel="preload" href="/deploy-docs/public/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/deploy-docs/public/chunks/framework.B_66xkI7.js">
    <link rel="modulepreload" href="/deploy-docs/public/chunks/theme.BGeXT1vf.js">
    <link rel="modulepreload" href="/deploy-docs/public/docker_use_elkf_elkf.md.fIFM4UVO.lean.js">
    <meta name="author" content="BaldHead">
    <meta name="keywords" content="deploy, docker, docker-compose , devops, linux">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link rel="icon" href="/favicon.ico">
    <script>(function(o){"use strict";(function(a){var e=window,s=document,c=o,r="".concat(s.location.protocol==="https:"?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),t=s.createElement("script"),i=s.getElementsByTagName("script")[0];t.type="text/javascript",t.setAttribute("charset","UTF-8"),t.async=!0,t.src=r,t.id="LA_COLLECT",c.d=t;var n=function(){e.LA.ids.push(c)};e.LA?e.LA.ids&&n():(e.LA=o,e.LA.ids=[],n()),i.parentNode.insertBefore(t,i)})()})({id:"CDqGooQbS8dts6eI",ck:"CDqGooQbS8dts6eI",hashMode:!0});</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d484562e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-bf745a85></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-bf745a85> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d484562e data-v-f250afe6><div class="VPNavBar has-sidebar top" data-v-f250afe6 data-v-5e616924><div class="wrapper" data-v-5e616924><div class="container" data-v-5e616924><div class="title" data-v-5e616924><div class="VPNavBarTitle has-sidebar" data-v-5e616924 data-v-3f3b6261><a class="title" href="/deploy-docs/" data-v-3f3b6261><!--[--><!--]--><!--[--><img class="VPImage logo" src="/deploy-docs/logo.svg" alt data-v-399d66d9><!--]--><span data-v-3f3b6261>deploy-docs</span><!--[--><!--]--></a></div></div><div class="content" data-v-5e616924><div class="content-body" data-v-5e616924><!--[--><!--]--><div class="VPNavBarSearch search" data-v-5e616924><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-5e616924 data-v-f0e7efd1><span id="main-nav-aria-label" class="visually-hidden" data-v-f0e7efd1>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/deploy-docs/docker/home.html" tabindex="0" data-v-f0e7efd1 data-v-147a3f81><!--[--><span data-v-147a3f81>docker</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/deploy-docs/linux/home.html" tabindex="0" data-v-f0e7efd1 data-v-147a3f81><!--[--><span data-v-147a3f81>linux</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/deploy-docs/java/home.html" tabindex="0" data-v-f0e7efd1 data-v-147a3f81><!--[--><span data-v-147a3f81>java</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-5e616924 data-v-1dd0e9da><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-1dd0e9da data-v-6be3d8b9 data-v-1eef6122><span class="check" data-v-1eef6122><span class="icon" data-v-1eef6122><!--[--><span class="vpi-sun sun" data-v-6be3d8b9></span><span class="vpi-moon moon" data-v-6be3d8b9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-5e616924 data-v-fabfed63 data-v-40ea7c05><!--[--><a class="VPSocialLink no-icon" href="https://github.com/bald-head/deploy-docs.git" aria-label="github" target="_blank" rel="noopener" data-v-40ea7c05 data-v-48fd50e0><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-5e616924 data-v-d14a2a99 data-v-6feeb30c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6feeb30c><span class="vpi-more-horizontal icon" data-v-6feeb30c></span></button><div class="menu" data-v-6feeb30c><div class="VPMenu" data-v-6feeb30c data-v-36c8b287><!----><!--[--><!--[--><!----><div class="group" data-v-d14a2a99><div class="item appearance" data-v-d14a2a99><p class="label" data-v-d14a2a99>Appearance</p><div class="appearance-action" data-v-d14a2a99><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d14a2a99 data-v-6be3d8b9 data-v-1eef6122><span class="check" data-v-1eef6122><span class="icon" data-v-1eef6122><!--[--><span class="vpi-sun sun" data-v-6be3d8b9></span><span class="vpi-moon moon" data-v-6be3d8b9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d14a2a99><div class="item social-links" data-v-d14a2a99><div class="VPSocialLinks social-links-list" data-v-d14a2a99 data-v-40ea7c05><!--[--><a class="VPSocialLink no-icon" href="https://github.com/bald-head/deploy-docs.git" aria-label="github" target="_blank" rel="noopener" data-v-40ea7c05 data-v-48fd50e0><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-5e616924 data-v-9b45631a><span class="container" data-v-9b45631a><span class="top" data-v-9b45631a></span><span class="middle" data-v-9b45631a></span><span class="bottom" data-v-9b45631a></span></span></button></div></div></div></div><div class="divider" data-v-5e616924><div class="divider-line" data-v-5e616924></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d484562e data-v-2363e075><div class="container" data-v-2363e075><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2363e075><span class="vpi-align-left menu-icon" data-v-2363e075></span><span class="menu-text" data-v-2363e075>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2363e075 data-v-70140d02><button data-v-70140d02>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d484562e data-v-7a49ca42><div class="curtain" data-v-7a49ca42></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-7a49ca42><span class="visually-hidden" id="sidebar-aria-label" data-v-7a49ca42> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-7a49ca42><section class="VPSidebarItem level-0" data-v-7a49ca42 data-v-e03646e6><!----><div class="items" data-v-e03646e6><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/home.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>首页</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-7a49ca42><section class="VPSidebarItem level-0" data-v-7a49ca42 data-v-e03646e6><div class="item" role="button" tabindex="0" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><h2 class="text" data-v-e03646e6>docker</h2><!----></div><div class="items" data-v-e03646e6><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/quick-start.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>快速开始</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" tabindex="0" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/FAQ/logs-too-large.html" data-v-e03646e6><!--[--><h3 class="text" data-v-e03646e6>常见问题</h3><!--]--></a><!----></div><div class="items" data-v-e03646e6><!--[--><div class="VPSidebarItem level-2 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/FAQ/logs-too-large.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>容器日志占用磁盘空间过大</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-7a49ca42><section class="VPSidebarItem level-0 has-active" data-v-7a49ca42 data-v-e03646e6><div class="item" role="button" tabindex="0" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><h2 class="text" data-v-e03646e6>docker-compose</h2><!----></div><div class="items" data-v-e03646e6><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/mysql.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>mysql</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/nginx.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>Nginx</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/powerjob.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>PowerJob</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/activemq.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>activemq</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/elasticsearch.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>elasticsearch</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/efk.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>efk</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/elk.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>elk</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/elkf/elkf.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>elkf</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/fastDFS/fastDFS.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>fastDFS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e03646e6 data-v-e03646e6><div class="item" data-v-e03646e6><div class="indicator" data-v-e03646e6></div><a class="VPLink link link" href="/deploy-docs/docker/use/filebeat/filebeat.html" data-v-e03646e6><!--[--><p class="text" data-v-e03646e6>filebeat</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d484562e data-v-1cac00d3><div class="VPDoc has-sidebar has-aside" data-v-1cac00d3 data-v-c58d461d><!--[--><!--]--><div class="container" data-v-c58d461d><div class="aside" data-v-c58d461d><div class="aside-curtain" data-v-c58d461d></div><div class="aside-container" data-v-c58d461d><div class="aside-content" data-v-c58d461d><div class="VPDocAside" data-v-c58d461d data-v-3afdab26><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3afdab26 data-v-613e85ab><div class="content" data-v-613e85ab><div class="outline-marker" data-v-613e85ab></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-613e85ab>On this page</div><ul class="VPDocOutlineItem root" data-v-613e85ab data-v-41249908><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3afdab26></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c58d461d><div class="content-container" data-v-c58d461d><!--[--><!--]--><main class="main" data-v-c58d461d><div style="position:relative;" class="vp-doc _deploy-docs_docker_use_elkf_elkf" data-v-c58d461d><div><h1 id="elfk" tabindex="-1">ELFK <a class="header-anchor" href="#elfk" aria-label="Permalink to &quot;ELFK&quot;">​</a></h1><nav class="table-of-contents"><ul><li><a href="#elfk">ELFK</a><ul><li><a href="#docker-compose">docker-compose</a></li><li><a href="#使用文档">使用文档</a></li><li><a href="#配置文件">配置文件</a><ul><li><a href="#elasticsearch">elasticsearch</a></li><li><a href="#kibana">kibana</a></li><li><a href="#logstash">logstash</a></li><li><a href="#filebeat">filebeat</a></li></ul></li></ul></li></ul></nav><h2 id="docker-compose" tabindex="-1">docker-compose <a class="header-anchor" href="#docker-compose" aria-label="Permalink to &quot;docker-compose&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 网桥 -&gt; 方便相互通讯</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">networks</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  elkf</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">services</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  elasticsearch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elasticsearch:7.14.1</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    container_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_elasticsearch</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">         # 容器名为&#39;elkf_elasticsearch&#39;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    hostname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    restart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unless-stopped</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                   # 指定容器退出后的重启策略为始终重启，但是不考虑在Docker守护进程启动时就已经停止了的容器</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    volumes</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                  # 数据卷挂载路径设置,将本机目录映射到容器目录</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/elasticsearch/data:/usr/share/elasticsearch/data</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/elasticsearch/logs:/usr/share/elasticsearch/logs</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#      - &quot;/application/middleware/elkf/elasticsearch/config/jvm.options:/usr/share/elasticsearch/config/jvm.options&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    environment</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                              # 设置环境变量,相当于docker run命令中的-e</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      TZ</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      LANG</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> en_US.UTF-8</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      TAKE_FILE_OWNERSHIP</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">true</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 权限</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      discovery.type</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> single-node</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      ES_JAVA_OPTS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">-Xmx512m -Xms512m</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      ELASTIC_PASSWORD</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">123456</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # elastic账号密码</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    ports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">9200:9200</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">9300:9300</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    networks</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  kibana</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kibana:7.14.1</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    container_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_kibana</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    hostname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_kibana</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    restart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    volumes</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    ports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">5601:5601</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    depends_on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    links</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    networks</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  logstash</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logstash:7.14.1</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    container_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_logstash</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    hostname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_logstash</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    restart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    environment</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      LS_JAVA_OPTS</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">-Xmx512m -Xms512m</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    volumes</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/logstash/data:/usr/share/logstash/data</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/logstash/config/logstash.yml:/usr/share/logstash/config/logstash.yml</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#      - &quot;/application/middleware/elkf/logstash/config/logstash.conf:/usr/share/logstash/config/logstash.conf&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/logstash/config/test:/usr/share/logstash/config/test</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#    command: logstash -f /usr/share/logstash/config/logstash.conf    # 指定logstash启动时使用的配置文件 - 指定单个文件</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    command</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logstash -f /usr/share/logstash/config/test</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">       # 指定logstash启动时使用的配置文件 - 指定目录夹（系统会自动读取文件夹下所有配置文件，并在内存中整合）</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    ports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">9600:9600</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#      - &quot;10001-10010:10001-10010&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">5044:5044</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    depends_on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    networks</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  filebeat</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> filebeat:7.14.1</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    container_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_filebeat</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    hostname</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf_filebeat</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    restart</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unless-stopped</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                   # 指定容器退出后的重启策略为始终重启，但是不考虑在Docker守护进程启动时就已经停止了的容器</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    volumes</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                  # 数据卷挂载路径设置,将本机目录映射到容器目录</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/filebeat/filebeat.yml:/usr/share/filebeat/filebeat.yml</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/filebeat/logs:/usr/share/filebeat/logs</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/application/middleware/elkf/filebeat/my-log:/usr/share/filebeat/my-log</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    environment</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">          # 设置环境变量,相当于docker run命令中的-e</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      TZ</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      LANG</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> en_US.UTF-8</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    depends_on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elasticsearch</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logstash</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    networks</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> elkf</span></span></code></pre></div><h2 id="使用文档" tabindex="-1"><a href="./README.html">使用文档</a> <a class="header-anchor" href="#使用文档" aria-label="Permalink to &quot;[使用文档](./README)&quot;">​</a></h2><h2 id="配置文件" tabindex="-1">配置文件 <a class="header-anchor" href="#配置文件" aria-label="Permalink to &quot;配置文件&quot;">​</a></h2><h3 id="elasticsearch" tabindex="-1">elasticsearch <a class="header-anchor" href="#elasticsearch" aria-label="Permalink to &quot;elasticsearch&quot;">​</a></h3><blockquote><p>elasticsearch.yml</p></blockquote><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cluster.name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">docker-cluster</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">network.host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">http.port</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 9200</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 开启es跨域</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">http.cors.enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">http.cors.allow-origin</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">*</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">http.cors.allow-headers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Authorization</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 开启安全控制</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">xpack.security.enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">xpack.security.transport.ssl.enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span></code></pre></div><blockquote><p>jvm.options</p></blockquote><div class="language-properties vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## JVM configuration</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">################################################################</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## IMPORTANT: JVM heap size</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">################################################################</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">##</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## You should always set the min and max JVM heap</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## size to the same value. For example, to set</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## the heap to 4 GB, set:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">##</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## -Xms4g</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## -Xmx4g</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">##</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## See https://www.elastic.co/guide/en/elasticsearch/reference/current/heap-size.html</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## for more information</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">##</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">################################################################</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Xms represents the initial size of total heap space</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Xmx represents the maximum size of total heap space</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-Xms1g</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-Xmx1g</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">################################################################</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## Expert settings</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">################################################################</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">##</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## All settings below this section are considered</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## expert settings. Don&#39;t tamper with them unless</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## you understand what you are doing</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">##</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">################################################################</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## GC configuration</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8-13:-XX:+UseConcMarkSweepGC</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8-13:-XX:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CMSInitiatingOccupancyFraction</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">75</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8-13:-XX:+UseCMSInitiatingOccupancyOnly</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## G1GC Configuration</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># NOTE: G1 GC is only supported on JDK version 10 or later</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># to use G1GC, uncomment the next two lines and update the version on the</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># following three lines to your version of the JDK</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 10-13:-XX:-UseConcMarkSweepGC</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 10-13:-XX:-UseCMSInitiatingOccupancyOnly</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">14-:-XX:+UseG1GC</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">14-:-XX:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">G1ReservePercent</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">25</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">14-:-XX:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">InitiatingHeapOccupancyPercent</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">30</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## JVM temporary directory</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">Djava.io.tmpdir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">${ES_TMPDIR}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## heap dumps</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># generate a heap dump when an allocation from the Java heap fails</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># heap dumps are created in the working directory of the JVM</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-XX:+HeapDumpOnOutOfMemoryError</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># specify an alternative path for heap dumps; ensure the directory exists and</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># has sufficient space</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-XX:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">HeapDumpPath</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># specify an alternative path for JVM fatal error logs</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-XX:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ErrorFile</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">logs/hs_err_pid%p.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">## JDK 8 GC logging</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-XX:+PrintGCDetails</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-XX:+PrintGCDateStamps</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-XX:+PrintTenuringDistribution</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-XX:+PrintGCApplicationStoppedTime</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-Xloggc:logs/gc.log</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-XX:+UseGCLogFileRotation</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-XX:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">NumberOfGCLogFiles</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">32</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">8:-XX:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GCLogFileSize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">64m</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># JDK 9+ GC logging</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">9-:-Xlog:gc*,gc+</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">age</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">trace,safepoint:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">file</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">logs/gc.log:utctime,pid,tags:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">filecount</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">32,</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">filesize</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">64m</span></span></code></pre></div><h3 id="kibana" tabindex="-1">kibana <a class="header-anchor" href="#kibana" aria-label="Permalink to &quot;kibana&quot;">​</a></h3><blockquote><p>kibana.yml</p></blockquote><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># ** THIS IS AN AUTO-GENERATED FILE **</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Default Kibana configuration for docker target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">server.name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kibana</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">server.host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0.0.0.0</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">server.publicBaseUrl</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">http://ekf_kibana:5601</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 这里地址改为你访问kibana的地址，不能以 / 结尾</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">elasticsearch.hosts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">http://elkf_elasticsearch:9200</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ]</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 使用容器的hostname或者使用自己的ip</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">xpack.monitoring.ui.container.elasticsearch.enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">elasticsearch.username</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">elastic</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # es账号</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">elasticsearch.password</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">123456</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">   # es密码</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">i18n.locale</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> zh-CN</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 中文</span></span></code></pre></div><h3 id="logstash" tabindex="-1">logstash <a class="header-anchor" href="#logstash" aria-label="Permalink to &quot;logstash&quot;">​</a></h3><blockquote><p>logstash.conf</p></blockquote><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Sample Logstash configuration for creating a simple</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Beats -&gt; Logstash -&gt; Elasticsearch pipeline.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">input {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    tcp {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        mode =&gt; &quot;server&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        host =&gt; &quot;0.0.0.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        port =&gt; 5044</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        codec =&gt; json{</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          charset=&gt;&quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # ex: 创建2个微服务demo，建立2个不同的输入，将两个服务的日志分别输入到不同的索引中</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    tcp {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        mode =&gt; &quot;server&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        host =&gt; &quot;0.0.0.0&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">         # 允许任意主机发送日志</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        type =&gt; &quot;java_demo_log_1&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 设定type以区分每个输入源</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        port =&gt; 10001</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        codec =&gt; json_lines</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">       # 数据格式</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    tcp {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        mode =&gt; &quot;server&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        host =&gt; &quot;0.0.0.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        type =&gt; &quot;java_demo_log_2&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        port =&gt; 10002</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        codec =&gt; json_lines</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">output {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # For detail config for elasticsearch as output,</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # See: https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # elasticsearch {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #     hosts =&gt; [&quot;http://elkf_elasticsearch:9200&quot;]</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #     #index =&gt; &quot;%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #     index =&gt; &quot;demo-log-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #     #user =&gt; &quot;elastic&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    #     #password =&gt; &quot;changeme&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    stdout{</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        codec =&gt; rubydebug</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    if [type] == &quot;java_demo_log_1&quot; {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        elasticsearch {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            action =&gt; &quot;index&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                            # 输出时创建映射</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            hosts  =&gt; &quot;http://elkf_elasticsearch:9200&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        # ElasticSearch地址和端口</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            index  =&gt; &quot;java_demo_log_1-%{+YYYY.MM.dd}&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">   # 指定索引名-按天</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            codec  =&gt; &quot;json&quot;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    if [type] == &quot;java_demo_log_2&quot; {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        elasticsearch {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            action =&gt; &quot;index&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            hosts  =&gt; &quot;http://elkf_elasticsearch:9200&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            index  =&gt; &quot;java_demo_log_2-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            codec  =&gt; &quot;json&quot;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div><blockquote><p>logstash.yml</p></blockquote><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">http.host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">0.0.0.0</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">xpack.monitoring.enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">xpack.monitoring.elasticsearch.hosts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">http://elkf_elasticsearch:9200</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ]</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">xpack.monitoring.elasticsearch.username</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">elastic</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">xpack.monitoring.elasticsearch.password</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">123456</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span></span></code></pre></div><blockquote><p>demo.conf</p></blockquote><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 日志输入</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">input {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    beats {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        port =&gt; 5044</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">filter {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 让无结构的日志内容结构化</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    grok {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        match =&gt; { &quot;message&quot; =&gt; &quot;(?&lt;datetime&gt;\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\.\d{3})\s+(?&lt;level&gt;\w+)\s+\d+\s+-+\s\[[^\[\]]+\]\s+(?&lt;class&gt;\S+)\s+:(?&lt;msg&gt;.*)&quot; }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    mutate {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        # 过滤字段</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        remove_field =&gt; [&quot;LOG_MAX_HISTORY_DAY&quot;, &quot;LOG_HOME&quot;, &quot;APP_NAME&quot;]</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        remove_field =&gt; [&quot;@version&quot;, &quot;_score&quot;, &quot;port&quot;, &quot;level_value&quot;, &quot;tags&quot;, &quot;_type&quot;, &quot;host&quot;]</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        remove_field =&gt; [&quot;agent&quot;, &quot;@timestamp&quot;, &quot;@timestamp&quot;, &quot;ecs&quot;, &quot;input&quot;, &quot;log&quot;]</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 日志输出-控制台</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">output {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    stdout{</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        codec =&gt; rubydebug</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 日志输出-es</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">output {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    elasticsearch {</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        action =&gt; &quot;index&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                       # 输出时创建映射</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        hosts  =&gt; &quot;http://elkf_elasticsearch:9200&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">   # ES地址和端口</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        user =&gt; &quot;elastic&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                       # ES用户名</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        password =&gt; &quot;123456&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                    # ES密码</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        index  =&gt; &quot;demo-%{+YYYY.MM.dd}&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">         # 指定索引名-按天</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        codec  =&gt; &quot;json&quot;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div><h3 id="filebeat" tabindex="-1">filebeat <a class="header-anchor" href="#filebeat" aria-label="Permalink to &quot;filebeat&quot;">​</a></h3><blockquote><p>filebeta.yml</p></blockquote><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 可参考 https://www.elastic.co/guide/en/beats/filebeat/7.14/filebeat-reference-yml.html</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 收集系统日志</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">filebeat</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  inputs</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    -</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> type</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> log</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      enabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      encoding</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> utf-8</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      paths</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/share/filebeat/my-log/demo*.log</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 系统日志路径</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      tags</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">demo</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ]</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # java多行日志合并</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      multiline</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">        pattern</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">^\d{4}\-\d{2}\-\d{2}\s\d{2}:\d{2}:\d{2}</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 匹配的正则 不是以 2021-10-01 12:00:00 格式开头的将合并到上一行</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">        negate</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                       # 是否反向匹配</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">        match</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> after</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                                       # 取值为 after 则放到上一行之后，取值为 before 则放到下一行之前</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">        timeout</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 3s</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 输出到logstash</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">output.logstash</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  hosts</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">elkf_logstash:5044</span><span style="--shiki-light:#B5695999;--shiki-dark:#C98A7D99;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # logstash服务器地址，可以有多个，以逗号&quot;,&quot;隔开</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-c58d461d data-v-5ad7158e><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-5ad7158e><span class="visually-hidden" id="doc-footer-aria-label" data-v-5ad7158e>Pager</span><div class="pager" data-v-5ad7158e><a class="VPLink link pager-link prev" href="/deploy-docs/docker/use/elk.html" data-v-5ad7158e><!--[--><span class="desc" data-v-5ad7158e>Previous page</span><span class="title" data-v-5ad7158e>elk</span><!--]--></a></div><div class="pager" data-v-5ad7158e><a class="VPLink link pager-link next" href="/deploy-docs/docker/use/fastDFS/fastDFS.html" data-v-5ad7158e><!--[--><span class="desc" data-v-5ad7158e>Next page</span><span class="title" data-v-5ad7158e>fastDFS</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d484562e data-v-0f9dfbd1><div class="container" data-v-0f9dfbd1><p class="message" data-v-0f9dfbd1>根据 <a href="https://www.gnu.org/licenses/" target="_blank"> GNU AFFERO GENERAL PUBLIC LICENSE</a> 许可证发布</p><p class="copyright" data-v-0f9dfbd1>Copyright © 2024 <a href="https://deploy.baldhead.cn" target="_blank">BaldHead</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"linux_home.md\":\"D1AruGBj\",\"docker_faq_logs-too-large.md\":\"BALt2Ojs\",\"docker_use_activemq.md\":\"BYLyLnzq\",\"docker_quick-start.md\":\"CXs5r_Hz\",\"docker_use_elasticsearch.md\":\"BPpHC76U\",\"java_home.md\":\"DVrdgszP\",\"docker_use_efk.md\":\"QN9KH9s3\",\"docker_use_fastdfs_readme.md\":\"DwNeJa5l\",\"en_index.md\":\"Drt5oiVm\",\"docker_use_powerjob.md\":\"CctwXaRU\",\"docker_use_fastdfs_fastdfs.md\":\"BNXHK0qk\",\"docker_use_mysql.md\":\"DfaAJbgd\",\"docker_use_filebeat_readme.md\":\"DHjESZ2r\",\"docker_use_nginx.md\":\"Cd1zZVAn\",\"docker_home.md\":\"BsHjuR-k\",\"docker_use_elkf_readme.md\":\"DvyJ_jII\",\"java_logging_index.md\":\"C4soHayt\",\"docker_use_filebeat_filebeat.md\":\"BdBZhKMD\",\"index.md\":\"5YKpyEWU\",\"docker_use_elkf_elkf.md\":\"fIFM4UVO\",\"docker_use_elk.md\":\"dUoI0DnI\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"VitePress\",\"description\":\"A VitePress site\",\"base\":\"/deploy-docs/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/bald-head/deploy-docs.git\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"HVG0I8JYN8\",\"apiKey\":\"1ce3df51e758636d077a6c9561e7e1c7\",\"indexName\":\"bald-headio\",\"placeholder\":\"Search Doc\"}},\"footer\":{\"message\":\"根据 <a href=\\\"https://www.gnu.org/licenses/\\\" target=\\\"_blank\\\"> GNU AFFERO GENERAL PUBLIC LICENSE</a> 许可证发布\",\"copyright\":\"Copyright © 2024 <a href=\\\"https://deploy.baldhead.cn\\\" target=\\\"_blank\\\">BaldHead</a>\"},\"nav\":[{\"text\":\"docker\",\"link\":\"/docker/home\",\"activeMatch\":\"/zh/guide/\"},{\"text\":\"linux\",\"link\":\"/linux/home\",\"activeMatch\":\"/zh/faq/\"},{\"text\":\"java\",\"link\":\"/java/home\",\"activeMatch\":\"/zh/guide/\"}],\"sidebar\":{\"/docker/\":[{\"text\":\"首页\",\"link\":\"/docker/home\"},{\"text\":\"docker\",\"items\":[{\"text\":\"快速开始\",\"link\":\"/docker/quick-start\"},{\"text\":\"常见问题\",\"link\":\"/docker/FAQ/logs-too-large\",\"items\":[{\"text\":\"容器日志占用磁盘空间过大\",\"link\":\"/docker/FAQ/logs-too-large\"}]}]},{\"text\":\"docker-compose\",\"items\":[{\"text\":\"mysql\",\"link\":\"/docker/use/mysql\"},{\"text\":\"Nginx\",\"link\":\"/docker/use/nginx\"},{\"text\":\"PowerJob\",\"link\":\"/docker/use/powerjob\"},{\"text\":\"activemq\",\"link\":\"/docker/use/activemq\"},{\"text\":\"elasticsearch\",\"link\":\"/docker/use/elasticsearch\"},{\"text\":\"efk\",\"link\":\"/docker/use/efk\"},{\"text\":\"elk\",\"link\":\"/docker/use/elk\"},{\"text\":\"elkf\",\"link\":\"/docker/use/elkf/elkf\"},{\"text\":\"fastDFS\",\"link\":\"/docker/use/fastDFS/fastDFS\"},{\"text\":\"filebeat\",\"link\":\"/docker/use/filebeat/filebeat\"}]}],\"/linux/\":[{\"text\":\"首页\",\"link\":\"/linux/home\"},{\"text\":\"linux\",\"items\":[{\"text\":\"快速开始\",\"link\":\"/linux/quick-start\"}]}],\"/java/\":[{\"text\":\"首页\",\"link\":\"/java/home\"},{\"text\":\"Logging\",\"items\":[{\"text\":\"logback & log4j2\",\"link\":\"java/logging/index\"}]}]}},\"locales\":{\"root\":{\"label\":\"简体中文\",\"lang\":\"zh\",\"dir\":\"src/zh\",\"title\":\"deploy-docs\",\"description\":\"更快的 deploy\"}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>